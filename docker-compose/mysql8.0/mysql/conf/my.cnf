[client]
socket = /var/run/mysqld/mysqld.sock

[mysqld]
#user = mysql
port = 3306
server_id = 100
datadir = /var/lib/mysql  # data_path
socket = /var/run/mysqld/mysqld.sock
pid_file = /var/run/mysqld/mysqld.pid  # data_path
secure-file-priv= NULL
#tmpdir = /tmp  # tmp_path
#secure_file_priv = /tmp  # path for load data and outfile

# Transaction
lock_wait_timeout = 5  # lock: metadata lock
innodb_lock_wait_timeout = 5  # lock: innodb row lock
transaction_isolation = READ-COMMITTED
sql_mode=""

# InnoDB
innodb_flush_log_at_trx_commit = 1
innodb_data_home_dir = /var/lib/mysql  # data_path
innodb_log_group_home_dir = /var/lib/mysql  # inno_log_path
innodb_buffer_pool_size = 128M  # memory
innodb_log_buffer_size = 32M
innodb_log_file_size = 512M
innodb_log_files_in_group = 2
innodb_file_per_table = 1
innodb_print_all_deadlocks = 1
innodb_flush_method = O_DIRECT  # linux only
innodb_online_alter_log_max_size = 512M
innodb_numa_interleave = ON

# Thread
max_connections = 500
max_connect_errors = 10000
interactive_timeout = 3600
wait_timeout = 3600

# Log
log_timestamps = SYSTEM
log_error = error.log
log_error_verbosity = 2
slow_query_log = ON
slow_query_log_file = slow.log
log-error = /var/lib/mysql/mysql-error.log
long_query_time = 0.5
min_examined_row_limit = 0
log_slow_admin_statements = ON
log_queries_not_using_indexes = OFF
log_throttle_queries_not_using_indexes= 0
general_log_file = query.log
general_log = 0

# Binlog
binlog_expire_logs_seconds = 1296000  # 15天
sync_binlog = 1
log_bin = bin
log_bin_index = bin.index
log_bin_trust_function_creators = 1
binlog_format = ROW
binlog_row_image = FULL
binlog_rows_query_log_events = ON
max_binlog_size = 512M
max_binlog_cache_size = 128M
gtid_mode = ON
enforce_gtid_consistency = ON
binlog_checksum = NONE

# Replication
log_slave_updates = ON
relay_log = relay
relay_log_index = relay.index
max_relay_log_size = 512M
relay_log_recovery = ON
master_info_repository = TABLE
relay_log_info_repository = TABLE
slave_net_timeout = 10
slave_parallel_type  = LOGICAL_CLOCK
slave_parallel_workers = 16
slave_preserve_commit_order = 1
slave_transaction_retries = 10
skip-slave-start = 1

# semi-sync
plugin-load = "semisync_master.so;semisync_slave.so"
rpl_semi_sync_master_timeout = 1000  # milliseconds
rpl_semi_sync_master_wait_for_slave_count = 1
rpl_semi_sync_master_wait_no_slave = OFF
rpl_semi_sync_master_wait_point = AFTER_SYNC


#[mysqld-8.0]
#binlog_expire_logs_seconds = 1296000  # 15天


[mysql]
default_character_set = utf8mb4
prompt = \\u@\\h \\R:\\m:\\s \\d>

[mysqldump]
max_allowed_packet = 32M
